
<#include "/common/head.html"/>


<div class="easyui-panel updatePage multiple" data-options="fit:true,border:false">
	<form id="ff" class="easyui-form" method="post">
		<table class="table1">
			<tr>
				<th><span id="Category_label">分类名册：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-combobox" id="Category" name="Category" value="${model.Category!''}" data-options="
	            				valueField: 'id',
   								textField: 'text',
   								editable:false,
   								fit: true,
	            				data: [
	            					{id:'', text:''}<#list dictDataCategory.keySet() as key>,{id:'${key}', text:'${dictDataCategory.get(key)}'}</#list>
	            				],
	            				required:true
	            				,panelHeight:'auto'
	            				,filter: function(q, row){
										var opts = $(this).combobox('options');
										return row[opts.textField].indexOf(q) >= 0;
								}
	            	" /></div>
				</td>

				<th><span id="Location_label">位置：</span></th>
				<td>
					<div class="wrap_input">

						<input id="Location" name="Location" id="Location" class="easyui-combobox" value="${model.Location!''}" data-options="
               				valueField: 'id',
        					textField: 'text',
        					fit: true,
        					url:'addressDic',
            				required:true,
            				panelHeight:200,
            				showDataSize:20,
            				filter: function(q, row){//当输入数据时会调用该方法进行筛选过滤,支持键值同时搜索
								var opts = $(this).combobox('options');
								return row[opts.textField].indexOf(q) >= 0;
							}"/></div>
				</td>

			</tr>
			<tr>
				<th><span id="Type_label">名称：</span></th>
				<td>
					<div class="wrap_input"><input id="Type" name="Type" id="Type" class="easyui-combobox" value="${model.Type!''}" data-options="
               				valueField: 'id',
        					textField: 'text',
        					fit: true,
        					data:[
        						{id:'', text:''}<#list dictDataType.keySet() as key>,{id:'${key}', text:'${dictDataType.get(key)}'}</#list>
	               			],
            				required:true
            				,panelHeight:'auto'
            				,filter: function(q, row){
									var opts = $(this).combobox('options');
									return row[opts.textField].indexOf(q) >= 0;
							}
               		"/></div>
				</td>

				<th><span id="Code_label">产品编码：</span></th>
				<td>
					<div class="wrap_input"><input id="Code" name="Code" id="Code" class="easyui-combobox" value="${model.Code!''}" data-options="
               				valueField: 'id',
        					textField: 'text',
        					fit: true,
        					data:[
        						{id:'', text:''}<#list dictDataCode.keySet() as key>,{id:'${key}', text:'${dictDataCode.get(key)}'}</#list>
	               			],
            				required:true,
            				panelHeight:'auto'
               		"/></div>
				</td>

			</tr>
			<tr>
				<th><span id="ICS_label">版本：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="ICS" id="ICS" value="${model.ICS!''}" data-options="fit: true"></input></div>
				</td>

				<th><span id="SN_label">序列号：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="SN" id="SN" value="${model.SN!''}" data-options="fit: true" ></input></div>
				</td>

			</tr>
			<tr>
				<th><span id="Status_label">状态：</span></th>
				<td>
					<div class="wrap_input"><input id="Status" name="Status" id="Status" class="easyui-combobox" value="${model.Status!''}" data-options="
               				editable:false,
               				valueField: 'id',
        					textField: 'text',
        					fit: true,
        					data:[
        						{id:'', text:''}<#list dictDataStatus.keySet() as key>,{id:'${key}', text:'${dictDataStatus.get(key)}'}</#list>
	               			],
	            				required:true
	            				,panelHeight:'auto'
               		"/></div>
				</td>
				<th><span id="User_label">使用人：</span></th>
				<td>
					<div class="wrap_input">
						<input id="User" name="User" class="easyui-combobox" value="${model.User!''}" data-options="
            				valueField: 'id',
  							textField: 'text',
  							fit: true,
            				data: [
            					{id:'', text:''}<#list dictDataUser.keySet() as key>,{id:'${key}', text:'${dictDataUser.get(key)}'}</#list>
            				],
            				panelHeight:'auto'" />
					</div>
				</td>
			</tr>
			<tr>
				<th><span id="OUT_from_label">借用日：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-datebox" type="text" name="OUT_from"
							   id="OUT_from" value="${model.OUT_from!''}" data-options="fit: true,editable:false"></input>
					</div>
				</td>
				<th><span id="OUT_till_label">归还日：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-datebox" type="text" name="OUT_till"
							   id="OUT_till" value="${model.OUT_till!''}" data-options="fit: true,editable:false"></input>
					</div>
				</td>
			</tr>
			<tr>
				<th><span id="Project_label">申请人：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-combobox" type="text" name="Project"
							   id="Project" value="${model.Project!''}" data-options="
	            				valueField: 'id',
   								textField: 'text',
   								fit: true,
	            				data: [
	            					{id:'', text:''}<#list dictDataUser.keySet() as key>,{id:'${key}', text:'${dictDataUser.get(key)}'}</#list>
	            				],
	            				panelHeight:'auto'" ></input>
					</div>
				</td>
				<th><span id="Platform_label">平台：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="Platform" id="Platform" value="${model.Platform!''}" data-options="fit: true"></input></div>
				</td>
			</tr>
			<tr>
				<th><span id="Inventory_Date_label">录入日期：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-datebox" type="text" name="Inventory_Date" id="Inventory_Date" value="${model.Inventory_Date!''}" data-options="fit: true,editable:false"></input></div>
				</td>
				<th><span id="Remarks_label">备注：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="Remarks" id="Remarks" value="${model.Remarks!''}" data-options="fit: true"></input></div>
				</td>
			</tr>
			<tr>
				<th><span id="PR_EMD_No_label">对应PR_EMD：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="PR_EMD_No" id="PR_EMD_No" value="${model.PR_EMD_No!''}" data-options="fit: true"></input></div>
				</td>
				<th><span id="PO_UPE_label">对应PO工程号：</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="PO_UPE" id="PO_UPE" value="${model.PO_UPE!''}" data-options="fit: true"></input></div>
				</td>
				<th><span id="Scrum_Team_label">小组</span></th>
				<td>
					<div class="wrap_input"><input class="easyui-textbox" type="text" name="Scrum_Team" id="Scrum_Team" value="${model.Scrum_Team!''}" data-options="fit: true"></input></div>
				</td>
			</tr>
		</table>
	</form>
</div>
<script>
top.window.subPage.save = save;
function save() {
	if($("#ff").form('validate')) {
		$.post("update", getParam(), function(data) {
			if(data.result=="success"){
				top.window.closeWindow();
				top.window.subPage.loadCurrDatagrid();
			}
		});
	}
}
function getParam() {
  console.log(window.location.search);
  var reg = new RegExp("(^|&)" + "id" + "=([^&]*)(&|$)", "i");
  var r = window.location.search.substr(1).match(reg);
  if (r != null)
     var ids = r[2];
  console.log(ids)
  console.log(r)
	var param = {
	    "id_first": ${model.id},
      "id": ids,
  	    "model.Category": getInputValue("Category"),
   	    "model.Location": getInputValue("Location"),
   	    "model.Type": getInputValue("Type"),
   	    "model.Code": getInputValue("Code"),
   	    "model.ICS": getInputValue("ICS"),
   	    "model.SN": getInputValue("SN"),
   	    "model.Status": getInputValue("Status"),
   	    "model.User": getInputValue("User"),
   	    "model.OUT_from": getInputValue("OUT_from"),
   	    "model.OUT_till": getInputValue("OUT_till"),
   	    "model.Project": getInputValue("Project"),
   	    "model.Platform": getInputValue("Platform"),
   	    "model.Remarks": getInputValue("Remarks"),
   	 	  "model.Inventory_Date": getInputValue("Inventory_Date"),
   	    "model.PR_EMD_No": getInputValue("PR_EMD_No"),
        "model.PO_UPE": getInputValue("PO_UPE"),
        "model.Scrum_Team": getInputValue("Scrum_Team"),
	}
	for(key in param) {
		if(!param[key]) {
			delete param[key];
		}
	}
	return param;
}

//扩展js
</script>
<#include "/common/foot.html"/>
