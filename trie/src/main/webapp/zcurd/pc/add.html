
<#include "/common/head.html"/>

 <div class="easyui-panel addPage multiple" data-options="fit:true,border:false,novalidate:true">
    <form class="easyui-form" id="ff" method="post" data-options="novalidate:true">
        <table class="table1">
            <tr>
           		<th><span id="Location_label">位置：</span></th>
               	<td>
	            	<div class="wrap_input">
	            		<input class="easyui-combobox" id="Location" name="Location" value="" data-options="
            				valueField: 'id',
							textField: 'text',
							fit: true,
            				url:'addressDic',
            				required:true,
            				panelHeight:200,
            				showDataSize:20,
            				filter: function(q, row){//当输入数据时会调用该方法进行筛选过滤,支持键值同时搜索
									var opts = $(this).combobox('options');
									return row[opts.textField].indexOf(q) >= 0;
							}" /></div>        	
           		</td>
           		<th><span id="SN_label">序列号：</span></th>
               	<td>
               		<div class="wrap_input">
               			<input class="easyui-textbox" type="text" name="SN" id="SN" value="" data-options="fit: true"></input>
               		</div>
           		</td>
            </tr>
            <tr>
           		<th><span id="Access_label">资产编号：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="Access" id="Access" value="" data-options="fit: true"></input></div>
           		</td>
           		<th><span id="Owner_label">所有人：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="Owner" id="Owner" value="" data-options="fit: true"></input></div>
           		</td>
            </tr>
            <tr>
           		<th><span id="pc_property_label">PC属性：</span></th>
               	<td>
	            	<div class="wrap_input"><input class="easyui-combobox" id="pc_property" name="pc_property" value="" data-options="
	            				editable:false,
	            				valueField: 'id',
   								textField: 'text',
   								fit: true,
	            				data: [
	            					{id:'', text:''}<#list dictDatapc_property.keySet() as key>,{id:'${key}', text:'${dictDatapc_property.get(key)}'}</#list>
	            				]
	            				
	            	" /></div>        	
           		</td>
           		<th><span id="IP_label">IP：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="IP" id="IP" value="" data-options="fit: true"></input></div>
           		</td>
            </tr>
            <tr>
           		<th><span id="MAC_label">MAC地址或备注：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="MAC" id="MAC" value="" data-options="fit: true"></input></div>
           		</td>
           		<th><span id="Package_label">打补丁：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="Package" id="Package" data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>无补丁</option>
	               			<option value='2'>有补丁</option>
	               		</select>
               		</div>
           		</td>
            </tr>
            <tr>
           		<th><span id="virus_label">杀毒软件：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="virus" id="virus" data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>无杀毒软件</option>
	               			<option value='2'>有杀毒软件</option>
	               		</select>
               		</div>
           		</td>
           		<th><span id="scan_virus_label">查毒：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="scan_virus" id="scan_virus" data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>未杀毒</option>
	               			<option value='2'>已杀毒</option>
	               		</select>
               		</div>
           		</td>
            </tr>
            <tr>
           		<th><span id="op_system_label">系统：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="op_system" id="op_system" value="" data-options="fit: true"></input></div>
           		</td>
           		<th><span id="reinstall_label">重装：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="reinstall" id="reinstall" data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>否</option>
	               			<option value='2'>是</option>
	               		</select>
               			</div>
           		</td>
            </tr>
            <tr>
           		<th><span id="infected_label">中毒：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="infected" id="infected" data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>否</option>
	               			<option value='2'>是</option>
	               		</select>
               		</div>
           		</td>
           		<th><span id="precaution_label">措施：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="precaution" id="precaution" value="" data-options="fit: true"></input></div>
           		</td>
            </tr>
            <tr>
           		<th><span id="user_label">使用人：</span></th>
               	<td>
               		<div class="wrap_input">
               			<input class="easyui-combobox" type="text" name="user" id="user" data-options="
            				valueField: 'id',
  							textField: 'text',
  							fit: true,
            				data: [
            					{id:'', text:''}<#list dictDataUser.keySet() as key>,{id:'${key}', text:'${dictDataUser.get(key)}'}</#list>
            				],
            				panelHeight:'auto'">
               		</div>
           		</td>
           		<th><span id="sign_label">签字：</span></th>
               	<td>
               		<div class="wrap_input">
               			<select class="easyui-combobox" name="sign" id=sign data-options="fit: true,panelHeight:'auto',editable:false">
	               			<option value=''></option>
	               			<option value='1'>否</option>
	               			<option value='2'>是</option>
	               		</select>
               		</div>
           		</td>
            </tr>
            <tr>
           		<th><span id="contact_way_label">联系方式：</span></th>
               	<td>
               		<div class="wrap_input"><input class="easyui-textbox" type="text" name="contact_way" id="contact_way" value="" data-options="fit: true"></input></div>
           		</td>
           		<th><span id="OUT_from_label">借用日：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-datebox" type="text" name="OUT_from"
							id="OUT_from" value="" data-options="fit: true,editable:false"></input>
					</div>
				</td>
            </tr>
            	<tr>
				<th><span id="OUT_till_label">归还日：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-datebox" type="text" name="OUT_till"
							id="OUT_till" value="" data-options="fit: true,editable:false"></input>
					</div>
				</td>
				<th><span id="Project_label">申请人：</span></th>
				<td>
					<div class="wrap_input">
						<input class="easyui-combobox" type="text" name="Project" id="Project" data-options="
            				valueField: 'id',
  							textField: 'text',
  							fit: true,
            				data: [
            					{id:'', text:''}<#list dictDataUser.keySet() as key>,{id:'${key}', text:'${dictDataUser.get(key)}'}</#list>
            				],
            				panelHeight:'auto'">
					</div>
				</td>
			</tr>
        </table>
    </form>
</div>
<script>
top.window.subPage.save = save;
function save() {
	if($("#ff").form('enableValidation').form('validate')) {
		$.post("add", getParam(), function(data) {
			if(data.result=="success"){
				top.window.closeWindow();
				top.window.subPage.loadCurrDatagrid();
			}
		});
	}
}
function getParam() {
	var param = {
       		"model.Location": getInputValue("Location"), 
       		"model.SN": getInputValue("SN"), 
       		"model.Access": getInputValue("Access"), 
       		"model.Owner": getInputValue("Owner"), 
       		"model.pc_property": getInputValue("pc_property"), 
       		"model.IP": getInputValue("IP"), 
       		"model.MAC": getInputValue("MAC"), 
       		"model.Package": getInputValue("Package"), 
       		"model.virus": getInputValue("virus"), 
       		"model.scan_virus": getInputValue("scan_virus"), 
       		"model.op_system": getInputValue("op_system"), 
       		"model.reinstall": getInputValue("reinstall"), 
       		"model.infected": getInputValue("infected"), 
       		"model.precaution": getInputValue("precaution"), 
       		"model.user": getInputValue("user"), 
       		"model.sign": getInputValue("sign"), 
       		"model.contact_way": getInputValue("contact_way"),
       		"model.OUT_from" : getInputValue("OUT_from"),
			"model.OUT_till" : getInputValue("OUT_till"),
			"model.Project" : getInputValue("Project")
	}
	for(key in param) {
		if(!param[key]) {
			delete param[key];
		}
	}
	return param;
}

//扩展js
</script>
<#include "/common/foot.html"/>